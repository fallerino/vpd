<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VPD-Tabellen für Pflanzenwachstum</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }
        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: #f1f1f1;
        }
        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
        }
        .tab button:hover {
            background-color: #ddd;
        }
        .tab button.active {
            background-color: #ccc;
        }
        .tabcontent {
            display: none;
            padding: 6px 12px;
            border: 1px solid #ccc;
            border-top: none;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        .optimal-anzucht { background-color: #4CAF50; color: white; }
        .akzeptabel-anzucht { background-color: #FFA500; }
        .suboptimal-anzucht { background-color: #FF6347; }
        .optimal-vegetation { background-color: #32CD32; color: white; }
        .akzeptabel-vegetation { background-color: #FFD700; }
        .suboptimal-vegetation { background-color: #FF4500; }
        .optimal-bluete { background-color: #1E90FF; color: white; }
        .akzeptabel-bluete { background-color: #87CEEB; }
        .suboptimal-bluete { background-color: #FF69B4; }
    </style>
</head>
<body>
    <h1>VPD-Tabellen für verschiedene Wachstumsphasen</h1>
    
    <div class="tab">
        <button class="tablinks" onclick="openTab(event, 'Anzucht')">Anzucht</button>
        <button class="tablinks" onclick="openTab(event, 'Vegetation')">Vegetation</button>
        <button class="tablinks" onclick="openTab(event, 'Bluete')">Blüte</button>
    </div>

    <div id="Anzucht" class="tabcontent">
        <h2>VPD-Tabelle für die Anzuchtphase</h2>
        <table id="anzuchtTable"></table>
    </div>

    <div id="Vegetation" class="tabcontent">
        <h2>VPD-Tabelle für die Vegetationsphase</h2>
        <table id="vegetationTable"></table>
    </div>

    <div id="Bluete" class="tabcontent">
        <h2>VPD-Tabelle für die Blütephase</h2>
        <table id="blueteTable"></table>
    </div>

    <script>
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        function berechneVPD(temperatur, luftfeuchtigkeit) {
            const svp = 0.61078 * Math.exp((17.27 * temperatur) / (temperatur + 237.3));
            const vpd = svp * (1 - luftfeuchtigkeit / 100);
            return vpd.toFixed(2);
        }

        function erstelleTabelle(tableId, phase) {
            const tabelle = document.getElementById(tableId);
            const temperaturen = Array.from({length: 17}, (_, i) => i + 16); // 16°C bis 32°C
            const luftfeuchtigkeiten = Array.from({length: 11}, (_, i) => 40 + i * 5); // 40% bis 90% in 5% Schritten

            // Kopfzeile
            let headerRow = tabelle.insertRow();
            headerRow.insertCell().innerHTML = "<th>Temp. (°C) / RH (%)</th>";
            for (let luft of luftfeuchtigkeiten) {
                headerRow.insertCell().innerHTML = `<th>${luft}%</th>`;
            }

            for (let temp of temperaturen) {
                let row = tabelle.insertRow();
                row.insertCell().innerHTML = `<th>${temp}°C</th>`;
                
                for (let luft of luftfeuchtigkeiten) {
                    let vpd = berechneVPD(temp, luft);
                    let cell = row.insertCell();
                    cell.textContent = vpd;
                    cell.className = bestimmeKlasse(vpd, phase);
                }
            }
        }

        function bestimmeKlasse(vpd, phase) {
            vpd = parseFloat(vpd);
            switch(phase) {
                case 'anzucht':
                    if (vpd >= 0.4 && vpd <= 0.8) return 'optimal-anzucht';
                    if (vpd > 0.8 && vpd <= 1.0) return 'akzeptabel-anzucht';
                    return 'suboptimal-anzucht';
                case 'vegetation':
                    if (vpd >= 0.8 && vpd <= 1.2) return 'optimal-vegetation';
                    if ((vpd > 0.6 && vpd < 0.8) || (vpd > 1.2 && vpd <= 1.4)) return 'akzeptabel-vegetation';
                    return 'suboptimal-vegetation';
                case 'bluete':
                    if (vpd >= 1.0 && vpd <= 1.5) return 'optimal-bluete';
                    if ((vpd > 0.8 && vpd < 1.0) || (vpd > 1.5 && vpd <= 1.7)) return 'akzeptabel-bluete';
                    return 'suboptimal-bluete';
            }
        }

        erstelleTabelle('anzuchtTable', 'anzucht');
        erstelleTabelle('vegetationTable', 'vegetation');
        erstelleTabelle('blueteTable', 'bluete');

        // Öffne standardmäßig den ersten Tab
        document.getElementsByClassName("tablinks")[0].click();
    </script>
</body>
</html>
